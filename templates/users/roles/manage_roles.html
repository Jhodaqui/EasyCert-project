{% extends "base.html" %}
{% block content %}
{% load static %} 
<div class="roles-container">
    <div class="roles-header">
        <h1 class="roles-title">Gesti贸n de Roles</h1>
        <a href="{% url 'logout' %}" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i>Cerrar sesi贸n
        </a>
    </div>
    
    <div class="stats-container">
        <div class="stat-card">
            <div class="stat-number">{{ users|length }}</div>
            <div class="stat-label">Usuarios totales</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ users.is_superuser|length }}</div>
            <div class="stat-label">Administradores</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ users.roles.staff|length }}</div>
            <div class="stat-label">Staff</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ users.roles.user|length }}</div>
            <div class="stat-label">Usuarios</div>
        </div>
    </div>
    
    {% if users %}
    <table class="roles-table">
        <tr>
            <th>Usuario</th>
            <th>Email</th>
            <th>Rol actual</th>
            <th>Cambiar rol</th>
        </tr>
        {% for u in users %}
        <tr>
            <td>{{ u.username }}</td>
            <td>{{ u.email }}</td>
            <td>
                <span class="role-badge role-{{ u.role }}">
                    {% if u.role == "user" %}Usuario{% endif %}
                    {% if u.role == "staff" %}Staff{% endif %}
                    {% if u.role == "admin" %}Admin{% endif %}
                </span>
            </td>
            <td>
                <form method="post" class="role-form">
                    {% csrf_token %}
                    <input type="hidden" name="user_id" value="{{ u.id }}">
                    <select name="role" class="role-select">
                        <option value="user" {% if u.role == "user" %}selected{% endif %}>Usuario</option>
                        <option value="staff" {% if u.role == "staff" %}selected{% endif %}>Staff</option>
                        <option value="admin" {% if u.role == "admin" %}selected{% endif %}>Admin</option>
                    </select>
                    <button type="submit" class="update-btn">Actualizar</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <div class="no-users">
        <p>No hay usuarios registrados en el sistema.</p>
    </div>
    {% endif %}
</div>

{% endblock %}

{% comment %} {% extends "base.html" %}
{% block content %}
<h1>Gesti贸n de Roles</h1>
<p><a href="{% url 'logout' %}">Cerrar sesi贸n</a></p>
<table>
  <tr>
    <th>Usuario</th>
    <th>Email</th>
    <th>Rol actual</th>
    <th>Cambiar rol</th>
  </tr>
  {% for u in users %}
  <tr>
    <td>{{ u.username }}</td>
    <td>{{ u.email }}</td>
    <td>{{ u.role }}</td>
    <td>
      <form method="post">
        {% csrf_token %}
        <input type="hidden" name="user_id" value="{{ u.id }}">
        <select name="role">
          <option value="user" {% if u.role == "user" %}selected{% endif %}>Usuario</option>
          <option value="staff" {% if u.role == "staff" %}selected{% endif %}>Staff</option>
          <option value="admin" {% if u.role == "admin" %}selected{% endif %}>Admin</option>
        </select>
        <button type="submit">Actualizar</button>
      </form>
    </td>
  </tr>
  {% endfor %}
</table>
{% endblock %} {% endcomment %}
